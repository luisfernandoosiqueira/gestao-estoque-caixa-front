<div class="p-4">
  <p-card *ngIf="!carregando && !erro">
    <h2>Detalhe da Venda #{{ venda?.id }}</h2>

    <p><b>Data/Hora:</b> {{ venda?.dataHora | date:'dd/MM/yyyy HH:mm' }}</p>
    <p><b>Usuário:</b> {{ venda?.usuario?.nomeCompleto }}</p>
    <p><b>Valor Recebido:</b> R$ {{ venda?.valorRecebido | number:'1.2-2' }}</p>
    <p><b>Troco:</b> R$ {{ venda?.troco | number:'1.2-2' }}</p>

    <h3 class="mt-3">Itens</h3>

    <p-table [value]="venda?.itens" styleClass="p-datatable-sm">
      <ng-template pTemplate="header">
        <tr>
          <th>Produto</th>
          <th>Qtd</th>
          <th>Preço</th>
          <th>Subtotal</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-i>
        <tr>
          <td>{{ i.produto?.nome }}</td>
          <td>{{ i.quantidade }}</td>
          <td>R$ {{ i.precoUnitario | number:'1.2-2' }}</td>
          <td>R$ {{ i.subtotal | number:'1.2-2' }}</td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="4">Nenhum item encontrado.</td>
        </tr>
      </ng-template>
    </p-table>

    <div class="mt-3">
      <button
        pButton
        type="button"
        label="Voltar"
        icon="pi pi-arrow-left"
        (click)="voltar()">
      </button>
    </div>
  </p-card>

  <p-card *ngIf="carregando">
    Carregando venda...
  </p-card>

  <p-card *ngIf="erro && !carregando">
    Erro ao carregar detalhes da venda.
    <button
      pButton
      type="button"
      label="Voltar"
      class="ml-2"
      (click)="voltar()">
    </button>
  </p-card>
</div>
